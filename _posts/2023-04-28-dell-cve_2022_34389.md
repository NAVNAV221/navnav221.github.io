---
layout: post
title: My 1st CVE on Dell
subtitle: CVE-2022-34389, Impersonate a legitimate dell customer to a dell support technician.
categories: CVE
cover-img: /assets/img/cve/dell/ecorp_dell.jpg
thumbnail-img: /assets/img/cve/dell/thumb_page.png
tags: [CVE, rate_limit, CVE-2022-34389]
comments: true
---
This CVE came from one of the product research I made with the one and the only: [Gad Abuazira](https://il.linkedin.com/in/gad-abuhatzira-099ba979) :top:

# How it all started?

My dell PC suffered from low battery all the time. Because I had a product warranty I call Dell support to figure it out.

They told me to download the following product: https://www.dell.com/support/incidents-online/he-il/remoteassist.

![image-20230427235947237](/assets/img/cve/dell/remote_assist_product.png)

<p style="text-align: center;">figure 1.0</p>

They send me the code via mail and we started a session where the supporter could control my PC:

![image-20230428011020626](/assets/img/cve/dell/supporter_conn.png)

<p style="text-align: center;">figure 1.1</p>

Because I split my PC to two screens I let the supporter to do his things on one screen while I opened WireShark on the other screen :sweat_smile:

Then I was able to see the communication made between my PC to their server.

## Scanning for fun

To make the scanning process easier I checked via netstat which address and port opened on my computer that relate to DellRemoteAssist.exe:

![image-20230428002756428](/assets/img/cve/dell/dell_pid.png)

<p style="text-align: center;">figure 1.2</p>

```
  TCP    192.168.68.105:54264   75.2.88.11:443         ESTABLISHED     1216
  TCP    192.168.68.105:54265   75.2.88.11:443         ESTABLISHED     1216
```

Now I was able to search more specifically on WireShark:

![image-20230428003153315](/assets/img/cve/dell/dell_wireshark_traffic.png)

<p style="text-align: center;">figure 1.3</p>

------



# Rate Limit bypass discovery

As you can see from figure 1.0, there is a 'code' we insert and connect to the supporter. When you catch the request with burp it looks like:

![image-20230428004945010](/assets/img/cve/dell/burp_code_req.png)

<p style="text-align: center;">figure 2.0</p>

There is two fields sent along with the request:
1.	The code that given to the user by Dell support assistant.
2.	 Server_tag that set default by default.

If you sent the request to Intruder and bruteforce 'code' field, there is no limit for your request.

Between all the request there are several 200 status codes that catch other user's support session:

![image-20230428005412083](/assets/img/cve/dell/burp_code_req_intruder.png)

<p style="text-align: center;">figure 2.1</p>

The response disclose sensitive user's & supporter's information:

![image-20230428005854898](/assets/img/cve/dell/intruder_catch_response.png)

<p style="text-align: center;">figure 2.2</p>

When we enter the other user's code we transfered to supporter-user session:

![image-20230428010214489](/assets/img/cve/dell/dell_assist_session_take_over.png)

<p style="text-align: center;">figure 2.3</p>

The end :cat: